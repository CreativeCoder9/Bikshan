$(document).ready(function(){
	AOS.init({ disable: 'mobile' });
	$('[data-bs-hover-animate]')
		.mouseenter( function(){ var elem = $(this); elem.addClass('animated ' + elem.attr('data-bs-hover-animate')) })
		.mouseleave( function(){ var elem = $(this); elem.removeClass('animated ' + elem.attr('data-bs-hover-animate')) });
});
$(document).ready(function(){
    var selector = $('.count');
    var replay = 'replay'
    
    function isScrolledIntoView(el) {
        var docViewTop = $(window).scrollTop();
        var docViewBottom = docViewTop + $(window).height();
        var elTop = el.offset().top;
        var elBottom = elTop + el.height();
        return ((elBottom <= docViewBottom) && (elTop >= docViewTop));
    }
    
    function animate_numbers(element) {
        if (isScrolledIntoView(element)) {
            element.addClass('started').css('visibility','visible')
            var startnum = element.text();
            if(element.text() % 1 === 0 && $.isNumeric(element.text())) {
                var step = function () { element.text(Math.ceil(this.Counter)); }
            } else if(element.text() % 1 !== 0 && $.isNumeric(element.text())) {
                var step = function () { element.text(this.Counter.toFixed(2)); }
            }
            jQuery({ Counter: 0 }).animate({ Counter: element.text() }, {
                duration : 2000,
                complete: function() { element.text($.trim(startnum)).addClass('finished').removeClass('started'); },
                step: step
            });
        }
    }
    
    selector.each(function () {
        $(this).css('visibility','hidden');
        animate_numbers($(this));
    });
    
    $(document).on("scroll", function () {
        selector.not('.finished, .started').each(function () {
            animate_numbers($(this));
        });
        selector.each(function () {
        if(!isScrolledIntoView($(this)) && $(this).hasClass(replay)) {
            $(this).removeClass('finished');
        }
        });
    });
});

particlesJS("particles-js", {
    "particles": {
		"number": {
			"value": 300,
			"density": {
				"enable": true,
				"value_area": 800
			}
		},
		"color": {
			"value": "#37c2ff"
		},
		"shape": {
			"type": "circle",
			"stroke": {
				"width": 0,
				"color": "#000000"
			},
			"polygon": {
				"nb_sides": 5
			},
			"image": {
				"src": "img/github.svg",
				"width": 100,
				"height": 100
			}
		},
		"opacity": {
			"value": 0.5,
			"random": false,
			"anim": {
				"enable": false,
				"speed": 1,
				"opacity_min": 0.1,
				"sync": false
			}
		},
		"size": {
			"value": 3,
			"random": true,
			"anim": {
				"enable": false,
				"speed": 40,
				"size_min": 0.1,
				"sync": false
			}
		},
		"line_linked": {
			"enable": true,
			"distance": 150,
			"color": "#37c2ff",
			"opacity": 0.4,
			"width": 1
		},
		"move": {
			"enable": true,
			"speed": 6,
			"direction": "none",
			"random": false,
			"straight": false,
			"out_mode": "out",
			"bounce": false,
			"attract": {
				"enable": false,
				"rotateX": 600,
				"rotateY": 1200
			}
		}
	},
	"interactivity": {
		"detect_on": "canvas",
		"events": {
			"onhover": {
				"enable": true,
				"mode": "grab"
			},
			"onclick": {
				"enable": true,
				"mode": "push"
			},
			"resize": true
		},
		"modes": {
			"grab": {
				"distance": 140,
				"line_linked": {
					"opacity": 1
				}
			},
			"bubble": {
				"distance": 400,
				"size": 40,
				"duration": 2,
				"opacity": 8,
				"speed": 3
			},
			"repulse": {
				"distance": 200,
				"duration": 0.4
			},
			"push": {
				"particles_nb": 4
			},
			"remove": {
				"particles_nb": 2
			}
		}
	},
	"retina_detect": true
});
//Table with search
$(document).ready(function() {
  $(".search").keyup(function () {
    var searchTerm = $(".search").val();
    var listItem = $('.results tbody').children('tr');
    var searchSplit = searchTerm.replace(/ /g, "'):containsi('")
    
  $.extend($.expr[':'], {'containsi': function(elem, i, match, array){
        return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
    }
  });
    
  $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e){
    $(this).attr('visible','false');
  });

  $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e){
    $(this).attr('visible','true');
  });

  var jobCount = $('.results tbody tr[visible="true"]').length;
    $('.counter').text(jobCount + ' item');

  if(jobCount == '0') {$('.no-result').show();}
    else {$('.no-result').hide();}
		  });
});
var firstName,lastName, phone, email, message;


const firebaseConfig = {
  apiKey: "AIzaSyBctQNIhg_WjLZYKfdyWVkXdqisgNu1y34",
  authDomain: "bikshan-web.firebaseapp.com",
  databaseURL: "https://bikshan-web.firebaseio.com",
  projectId: "bikshan-web",
  storageBucket: "bikshan-web.appspot.com",
  messagingSenderId: "1042636519347",
  appId: "1:1042636519347:web:51278f909eaff51ebe7dc6",
  measurementId: "G-91J86VSHCV"
};

  firebase.initializeApp(firebaseConfig);
  firebase.analytics();


  var db = firebase.firestore();

// console.log(document.getElementById("sendmessage").innerHTML);
// Thank you plug in------------>
const myform = document.getElementById("my-form");
myform.addEventListener("submit" , (e) => {
    e.preventDefault();
    // document.getElementById("sendButton").style.display = "none";
    // document.getElementById("sendingStatus1").style.display = "block";
    firstName = formValue("firstname");
    lastName = formValue("lastname");
    phone = formValue("phonenumber")
    email = formValue("email");
    message = formValue("messages");
    var response = grecaptcha.getResponse();
    if(response.length == 0){
    alert("reCapcha challenge failed! Please try again!")
    grecaptcha.reset();
    } else {
      console.log(firstName, lastName, email, message, phone, response);
      submitOnFirebase(firstName, lastName, email, phone, message);
      document.getElementById("loading").style.display = "block";
    }

    


})


function formValue(id){
    var inputValue = document.getElementById(id);
    return inputValue.value;
}

function submitOnFirebase(firstName, lastName, email, phone, message){
    db.collection("Contact_request").add({
        FirstName: firstName,
        LastName: lastName
        Email: email,
        Phone: phone,
        Message: message
    })
    .then(function(docRef) {
        document.getElementById("loading").style.display = "none";
        document.getElementById("error-message").style.display = "none";
        document.getElementById("sent-message").style.display = "block";
        // document.getElementById("sendButton").style.display = "block";
        myform.reset();
        grecaptcha.reset();

    })
    .catch(function(error) {
        document.getElementById("loading").style.display = "none";
        document.getElementById("error-message").style.display = "block";
        console.error("Error adding document: ", error);
        document.getElementById("sent-message").style.display = "none";
    });
}


// //subscribe form
// const subscribeForm = document.getElementById("subscribe");
// // console.log(subscribeForm);
// subscribe.addEventListener("submit" , (e) => {
//     e.preventDefault();
//     subscriber = formValue("subscriber");
//     addSubscriber(subscriber);
// })
//
// function addSubscriber(subscriber){
//     db.collection("EC_Subscriber").add({
//         Email: subscriber,
//     })
//     .then(function(docRef) {
//         document.getElementById("submitButton2").value = "Subscribed!!";
//         subscribeForm.reset();
//     })
//     .catch(function(error) {
//         document.getElementById("submitButton2").value = "ERROR!!";
//     });
// }
